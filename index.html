<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />

<style>

div,textarea {
	border-style: solid ;
	border-width: 1px ;
	color: grey;
	margin-bottom: 3%;
	padding: .5%;
	font-style: italic;
	font-family: verdana;
	font-size: 100%;
	display: inline-block;
	width: 40%;
}
.tableft,.tabright {
	width: 48%;
	color: black;
	font-style: normal;
/*
	display: block;
	height: 90%;
	position: relative;
	top: 0px;
*/
}

.tableft {
	float: left;
}
.tabright {
	float: right;
}
#addressdiv {
	height: 20%;
}
label {
	padding: .5%;
	margin-bottom: 2%;
	display: inline-block;
	float: left;
	width: 25%;
}

input {
	width: 40%;
	margin-bottom: 3%;
}
</style>
</head>
<body>
<div class=tableft>
<h1>Avec form et Input</h1>
<form id="form">
<label>Nom Prénom : </label><input type="text" id="name" name="Nom Prénom"></br>
<label>Adresse :  </label><textarea id="address" name="Adresse" rows=5 cols=20 onchange="osmdiv()">Your address</textarea></br>
<label>Latitude : </label><input type="text" id="lat" name="Latitude"></br>
<label>Longitude : </label><input type="text" id="long" name="Longitude"></br>
</form>
</div>
<div class=tabright>
<h1>En div</h1>
<!--
<div id="contenu">Lat GMAP</div><br/>
-->
<label>Nom Prenom </label> <div id="namediv" contenteditable="true">Ajouter </div><br/>
<label>Adresse </label> <div id="addressdiv" contenteditable="true" onchange="osmdiv()">Ajouter </div><br/>
<label>Adresse </label> <textarea id="address" name="Adresse" rows=5 onchange="osmdiv()">Your address</textarea><br/>
<label>Longitude OSM</label> <div id="longdivosm">long OSM</div><br/>
<label>Latitude OSM</label> <div id="latdivosm">lat OSM</div><br/>
<label>Longitude GMAP</label> <div id="longdivgmap">Long GMAP</div><br/>
<label>Latitude GMAP</label> <div id="latdivgmap">Lat GMAP</div><br/>
</div>
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script>

function osmdiv() {
	var xmlhttp = new XMLHttpRequest();
	var urlosm = "http://nominatim.openstreetmap.org/search?email=jerome.avond@alolise.org&format=json&q=" + document.getElementById("address").value;
	var urlgmp = "https://maps.googleapis.com/maps/api/geocode/json?address=" + document.getElementById("address").value + "&key=AIzaSyBV0jQvMpkmQ2QINkntL7liDvooxYt-WfQ";
//AIzaSyBV0jQvMpkmQ2QINkntL7liDvooxYt-WfQ
//

$.getJSON(urlgmp, function(data) {
	//document.getElementById("contenu").innerHTML=data.results[0].formatted_address;
	glat=data.results[0].geometry.location.lat;
	glong=data.results[0].geometry.location.lng;
	document.getElementById("latdivgmap").innerHTML=glat;
	document.getElementById("longdivgmap").innerHTML=glong;
});
	

var latlongosm = $.getJSON(urlosm, function(data) {
	//document.getElementById("contenu").innerHTML=data;
	olat=data[0].lat;
	olong=data[0].lon;
	document.getElementById("latdivosm").innerHTML=latlongosm.lat;
	document.getElementById("longdivosm").innerHTML=latlongosm.long;
});

	xmlhttp.onreadystatechange = function() {
							if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
								var monjson = JSON.parse(xmlhttp.responseText);
								affiche(monjson);
							}
						}
	xmlhttp.open("GET", urlosm, true);
	xmlhttp.send();
	xmlhttp.open("GET", urlgmp, true);
	xmlhttp.send();

	function affiche(json) {
		if (typeof json[0] != 'undefined') {
			var jlat = json[0].lat;
			var jlon = json[0].lon;
			return {
				"lat":jlat,
				"long":jlong
			}
/*
			document.getElementById("lat").value=jlat;
			document.getElementById("long").value=jlon;
*/
		} else {
			return {
				"lat":"indefinie",
				"long":"indefinie"
			}
/*
			document.getElementById("lat").value="indefinie";
			document.getElementById("long").value="indefinie";
*/
		}
	}
}
function osm() {
	var xmlhttp = new XMLHttpRequest();
	var url = "http://nominatim.openstreetmap.org/search?format=json&q=" + document.getElementById("address").value;

	xmlhttp.onreadystatechange = function() {
							if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
								var monjson = JSON.parse(xmlhttp.responseText);
								affiche(monjson);
							}
						}
	xmlhttp.open("GET", url, true);
	xmlhttp.send();

	function affiche(json) {
		if (typeof json[0] != 'undefined') {
			var jlat = json[0].lat;
			var jlon = json[0].lon;
			document.getElementById("lat").value=jlat;
			document.getElementById("long").value=jlon;
		} else {
			document.getElementById("lat").value="indefinie";
			document.getElementById("long").value="indefinie";
		}
	}
}

</script>
</body>
</html>
